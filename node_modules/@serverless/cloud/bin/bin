#!/usr/bin/env node
'use strict'

if (process.version.slice(1).split('.')[0] < 12) {
  console.log('Serverless Cloud requires Node.js 12+')
  process.exit(-1)
}

if (!process.env.SERVERLESS_CLOUD_ENDPOINT) {
  const stage = process.env.CLOUD_STAGE

  process.env.SERVERLESS_CLOUD_ENDPOINT =
    stage === 'prod' || stage === undefined
      ? 'https://api.cloud.serverless.com'
      : `https://${stage === 'dev' ? 'api' : stage}.cloud.serverless-dev.com`
}

if (!process.env.SERVERLESS_PLATFORM_STAGE) {
  process.env.SERVERLESS_PLATFORM_STAGE =
    process.env.SERVERLESS_CLOUD_ENDPOINT.indexOf('serverless.com') === -1 ? 'dev' : 'prod'
}

require('../dist')
